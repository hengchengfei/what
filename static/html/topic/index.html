<!doctype html>
<html ng-app="What">
<head>
    <meta charset="UTF-8">
    <title></title>

    <link rel="import" href="../include/link.html?__inline">
    <link rel="stylesheet" href="include/style.css?__inline">
</head>
<body class="">

    <div class="wait"></div>

    <div class="page" ng-controller="TopicCtrl">
        <section class="panel" ng-repeat="item in list">
            <div class="c_head">
                <img class="cicle" src="{{item.create_user.user_avatar}}" width="44" height="44">
                <p class="u_name">{{item.create_user.user_name}}</p>
                <p class="c_time">{{item.create_time | time}}</p>
            </div>

            <!-- start animation -->
                <div class="c_img i_one" onclick="img_one(this)" ng-if="item.animation.animation_class == 'WhatAnimationRippleEffect'">
                    <div index="1">
                        <img src="{{item.photos[0].url_middle}}">
                    </div>
                    <div index="2">
                        <img src="{{item.photos[1].url_middle}}">
                    </div>
                </div>

                <!-- 不吃药打死你 -->
                <div class="c_img i_two" onclick="img_two(this)" ng-if="content.animation.animation_class == 'WhatAnimationRippleEffect'">
                    <div index="1" data-image="url({{content.photos[0].url_middle}});"></div>
                    <div index="2" data-image="url({{content.photos[1].url_middle}});"></div>
                </div>

                <div class="c_img i_three" onclick="img_three(this)" ng-if="item.animation.animation_class == 'WhatAnimationOglFlip'">
                    <div index="1">
                        <img src="{{item.photos[0].url_middle}}">
                    </div>
                    <div index="2">
                        <img src="{{item.photos[1].url_middle}}">
                    </div>
                </div>
                
                <div class="c_img i_four" onclick="img_four(this)" ng-if="item.animation.animation_class == 'WhatAnimationOpenDoor'">
                    <div class="i_four_one">
                        <div index="1">
                            <div style="background-image: url({{item.photos[0].url_middle}});"></div>
                        </div>
                        <div index="2">
                            <div style="background-image: url({{item.photos[1].url_middle}});"></div>
                        </div>
                    </div>
                    <div class="i_four_two">
                        <div index="3">
                            <div style="background-image: url({{item.photos[0].url_middle}});"></div>
                        </div>
                        <div index="4">
                            <div style="background-image: url({{item.photos[1].url_middle}});"></div>
                        </div>
                    </div>
                </div> 
                
                <div class="c_img i_five" onclick="img_five(this)" ng-if="item.animation.id == animation_class == 'WhatAnimationFallen'">
                    <div index="1">
                        <div class="three_1" style="background-image:url({{item.photos[0].url_middle}});background-position: 0% 0%;"></div>
                        <div class="three_2" style="background-image:url({{item.photos[0].url_middle}});background-position: 33% 0%;"></div>
                        <div class="three_3" style="background-image:url({{item.photos[0].url_middle}});background-position: 66% 0%;"></div>
                        <div class="three_4" style="background-image:url({{item.photos[0].url_middle}});background-position: 99% 0%;"></div>

                        <div class="three_5"  style="background-image:url({{item.photos[0].url_middle}});background-position: 0% 20%;"></div>
                        <div class="three_6"  style="background-image:url({{item.photos[0].url_middle}});background-position: 33% 20%;"></div>
                        <div class="three_7"  style="background-image:url({{item.photos[0].url_middle}});background-position: 66% 20%;"></div>
                        <div class="three_8" style="background-image:url({{item.photos[0].url_middle}});background-position: 99% 20%;"></div>

                        <div class="three_9"  style="background-image:url({{item.photos[0].url_middle}});background-position: 0% 40%;"></div>
                        <div class="three_10"  style="background-image:url({{item.photos[0].url_middle}});background-position: 33% 40%;"></div>
                        <div class="three_11"  style="background-image:url({{item.photos[0].url_middle}});background-position: 66% 40%;"></div>
                        <div class="three_12"  style="background-image:url({{item.photos[0].url_middle}});background-position: 99% 40%;"></div>

                        <div class="three_13"  style="background-image:url({{item.photos[0].url_middle}});background-position: 0% 60%;"></div>
                        <div class="three_14"  style="background-image:url({{item.photos[0].url_middle}});background-position: 33% 60%;"></div>
                        <div class="three_15"  style="background-image:url({{item.photos[0].url_middle}});background-position: 66% 60%;"></div>
                        <div class="three_16"  style="background-image:url({{item.photos[0].url_middle}});background-position: 99% 60%;"></div>

                        <div class="three_17"  style="background-image:url({{item.photos[0].url_middle}});background-position: 0% 80%;"></div>
                        <div class="three_18"  style="background-image:url({{item.photos[0].url_middle}});background-position: 33% 80%;"></div>
                        <div class="three_19"  style="background-image:url({{item.photos[0].url_middle}});background-position: 66% 80%;"></div>
                        <div class="three_20"  style="background-image:url({{item.photos[0].url_middle}});background-position: 99% 80%;"></div>

                        <div class="three_21"  style="background-image:url({{item.photos[0].url_middle}});background-position: 0% 100%;"></div>
                        <div class="three_22"  style="background-image:url({{item.photos[0].url_middle}});background-position: 33% 100%;"></div>
                        <div class="three_23"  style="background-image:url({{item.photos[0].url_middle}});background-position: 66% 100%;"></div>
                        <div class="three_24"  style="background-image:url({{item.photos[0].url_middle}});background-position: 99% 100%;"></div>
                    </div>
                    <div index="2">
                        <div class="three_1" style="background-image:url({{item.photos[1].url_middle}});background-position: 0% 0%;"></div>
                        <div class="three_2" style="background-image:url({{item.photos[1].url_middle}});background-position: 33% 0%;"></div>
                        <div class="three_3" style="background-image:url({{item.photos[1].url_middle}});background-position: 66% 0%;"></div>
                        <div class="three_4" style="background-image:url({{item.photos[1].url_middle}});background-position: 99% 0%;"></div>

                        <div class="three_5"  style="background-image:url({{item.photos[1].url_middle}});background-position: 0% 20%;"></div>
                        <div class="three_6"  style="background-image:url({{item.photos[1].url_middle}});background-position: 33% 20%;"></div>
                        <div class="three_7"  style="background-image:url({{item.photos[1].url_middle}});background-position: 66% 20%;"></div>
                        <div class="three_8" style="background-image:url({{item.photos[1].url_middle}});background-position: 99% 20%;"></div>

                        <div class="three_9"  style="background-image:url({{item.photos[1].url_middle}});background-position: 0% 40%;"></div>
                        <div class="three_10"  style="background-image:url({{item.photos[1].url_middle}});background-position: 33% 40%;"></div>
                        <div class="three_11"  style="background-image:url({{item.photos[1].url_middle}});background-position: 66% 40%;"></div>
                        <div class="three_12"  style="background-image:url({{item.photos[1].url_middle}});background-position: 99% 40%;"></div>

                        <div class="three_13"  style="background-image:url({{item.photos[1].url_middle}});background-position: 0% 60%;"></div>
                        <div class="three_14"  style="background-image:url({{item.photos[1].url_middle}});background-position: 33% 60%;"></div>
                        <div class="three_15"  style="background-image:url({{item.photos[1].url_middle}});background-position: 66% 60%;"></div>
                        <div class="three_16"  style="background-image:url({{item.photos[1].url_middle}});background-position: 99% 60%;"></div>

                        <div class="three_17"  style="background-image:url({{item.photos[1].url_middle}});background-position: 0% 80%;"></div>
                        <div class="three_18"  style="background-image:url({{item.photos[1].url_middle}});background-position: 33% 80%;"></div>
                        <div class="three_19"  style="background-image:url({{item.photos[1].url_middle}});background-position: 66% 80%;"></div>
                        <div class="three_20"  style="background-image:url({{item.photos[1].url_middle}});background-position: 99% 80%;"></div>

                        <div class="three_21"  style="background-image:url({{item.photos[1].url_middle}});background-position: 0% 100%;"></div>
                        <div class="three_22"  style="background-image:url({{item.photos[1].url_middle}});background-position: 33% 100%;"></div>
                        <div class="three_23"  style="background-image:url({{item.photos[1].url_middle}});background-position: 66% 100%;"></div>
                        <div class="three_24"  style="background-image:url({{item.photos[1].url_middle}});background-position: 99% 100%;"></div>
                    </div>
                </div>

                <!-- 自拍中勿打扰 -->
                <div class="c_img i_six" onclick="img_six(this)" ng-if="content.animation.animation_class == 'WhatAnimationYUGLPowDistortion'">
                </div>


                <div class="c_img i_seven" onclick="img_seven(this)" ng-if="item.animation.animation_class == 'WhatAnimationYUGLSwap'">
                    <div index="1">
                        <img src="{{item.photos[0].url_middle}}">
                    </div>
                    <div index="2">
                        <img src="{{item.photos[1].url_middle}}">
                    </div>
                </div> 
            <!-- end animation -->

            <ul class="c_topic">
                <li ng-repeat="ele in item.topics">
                    <a href="?id={{ele.id}}">{{ele.name}}</a>
                </li>
            </ul>
            <div class="c_zan">
                <em class="before">同感</em>
            </div>
            <div class="c_foot">
                <div class="c_watched">
                    <em>{{item.count_info.view_count}}</em>
                </div>
                <a href="../content?id={{item.id}}"><em class="c_content"></em></a>
            </div>
        </section>
    </div>

    <link rel="import" href="../include/script.html?__inline">
    <link rel="import" href="../include/download/index.html?__inline">

    <script>
        var app = angular.module('What', [], angular.noop);

        app.controller('TopicCtrl', function ($scope, $http) {
            $scope.list = [];

            $http.get("http://api.mkwhat.com/self-app//topic/contentList?topic_id=" + get_url_param("id") + "&page=1")
            .success(function (data) {
                if ( ! data.data || ! data.data.contents) {
                    get_topic_error();
                    return;
                }

                $scope.list = data.data.contents;


                var url_link = data.data.share_info.url_link;
                $("title").text(url_link.substr(url_link.indexOf("#")));
            })
            .error(get_topic_error);
        });

        app.filter('time', function () {

            return function (input) {

                var time = (Date.now() - input) / 1000;

                if (time <= 0) {
                    return "刚刚";
                }
                if (time < 60) {
                    return Math.floor(time) + "秒前";
                }
                if (time < 60 * 60) {
                    return Math.floor(time / 60) + "分钟前";
                }
                if (time < 60 * 60 * 24) {
                    return Math.floor(time / 60) + "小时前";
                }

                return Math.floor(time / 60 / 60 / 24) + "小时前";
            };
        });

        function get_topic_error () {
            // body...
        }

        $(".c_img").css("height", $(".c_img").css("width"));
    </script>
</body>
</html>
